# HTML5MusicPlayer

使用 HTML5 写的一个音乐播放器,你可以在 [我的博客](http://hwaphon.site/?p=280) 中看到关于各个细节的解释。

---

### 2.0 版本 - 2017.03

![image](https://github.com/hwaphon/HTML5MusicPlayer/blob/gh-pages/2.0.png)

此版本的播放器新增功能如下：

1. 支持音乐队列
2. 支持同时上传多个音乐文件，对于非音乐文件会自动过滤
3. 支持快进功能
4. 支持前一首和下一首功能
5. 界面优化

如果想自定义 `webkit` 浏览器的 `progressbar` 样式 ，可以通过 `progress::-webkit-progress-value { }` 定义已经完成进度的样式，可以通过 `progress::-webkit-progress-bar { }` 定义全部进度的样式。

如果想定义 `Firefox` 浏览器的 `progressbar` 样式，可以通过 `progress::-moz-progress-bar` 定义已完成进度的样式，而其他样式可以直接在 `progress` 中定义，而且值得一提的是，`Firefox` 浏览器支持为 `progress` 设置圆角，而这是其他浏览器不支持的。

可以为除 `Firefox` 以外的浏览器设置 `scrollbar` 的样式，通过 `::-webkit-scrollbar` 设置滚动路径的样式，通过 `::-webkit-scrollbar-thumb` 设置滚动滑块的样式。

如果你想利用比较炫酷的渐变颜色，可以去 [webgradients](https://webgradients.com/)。

关于音乐文件播放时长的获取，由于音乐加载也需要一定的时间，所以千万不要在调用 `player.play()` 方法后就直接获取音乐时长，因为这个时候你很可能获取失败，并返回一个 `NaN`,我就碰到了这个问题，我选择的解决方案是，在 `player.play()` 之后设置一个 `setTimeout`，并提供一个回调函数去获取播放时长，我选择的定时时间是 500ms，我利用这个方案后，就再也没出现获取失败的问题。

仍然存在的问题:

1. 为了不每次打开浏览器的时候都上传音乐，我尝试将获取到的音乐信息利用 `localStorage` 保存下来，不过再打开浏览器的时候，浏览器提示已经没有权限播放音乐，因为浏览器本没有权限播放本地文件，我们也是勉强通过 `URL.createObjectURL()` 让音乐可以播放，我猜测这是动态赋予权限，当浏览器关闭，那个权限就被收回了，所以本音乐播放器还需要其他持久化技术。

2. 经过测试，发现上传的 `mp3` 格式文件无法在 `Opera` 中播放，而 `ogg` 是可以的。当然这我们也无能为力，毕竟各浏览器支持的格式本就不是我们能够左右的。

本音乐播放器将会持续更新完善，可能在不久的将来会添加的功能 ：

1. 随机播放和顺序播放
2. 支持删除音乐
3. 界面优化

---
### 1.0 版本 - 2016.12

![image](https://github.com/hwaphon/HTML5MusicPlayer/blob/gh-pages/1.0.gif)

这是音乐播放器的初始版本，当时此播放器支持以下功能：

1. 支持从本地上传音乐播放
2. 支持直接拖拽音乐到界面直接播放
3. 支持调节音乐的音量

可见，这个版本的播放器还不能称之为音乐播放器，因为它不支持音乐队列，所以它无法完成上一首和下一首的功能，而且最致命的是它不支持快进功能。不过此版本还是有一个不错的特性，就是可以通过鼠标拖拽本地音乐文件直接播放。

要播放本地文件，我们需要利用 `URL.createObjectURL(file)` 对文件地址进行转换，否则浏览器无权播放本地文件。
